{"ast":null,"code":"/**\n * @author mrdoob / http://mrdoob.com/\n */\nimport { Cache } from './Cache.js';\nimport { DefaultLoadingManager } from './LoadingManager.js';\nvar loading = {};\n\nfunction FileLoader(manager) {\n  this.manager = manager !== undefined ? manager : DefaultLoadingManager;\n}\n\nObject.assign(FileLoader.prototype, {\n  load: function (url, onLoad, onProgress, onError) {\n    if (url === undefined) url = '';\n    if (this.path !== undefined) url = this.path + url;\n    url = this.manager.resolveURL(url);\n    var scope = this;\n    var cached = Cache.get(url);\n\n    if (cached !== undefined) {\n      scope.manager.itemStart(url);\n      setTimeout(function () {\n        if (onLoad) onLoad(cached);\n        scope.manager.itemEnd(url);\n      }, 0);\n      return cached;\n    } // Check if request is duplicate\n\n\n    if (loading[url] !== undefined) {\n      loading[url].push({\n        onLoad: onLoad,\n        onProgress: onProgress,\n        onError: onError\n      });\n      return;\n    } // Check for data: URI\n\n\n    var dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\n    var dataUriRegexResult = url.match(dataUriRegex); // Safari can not handle Data URIs through XMLHttpRequest so process manually\n\n    if (dataUriRegexResult) {\n      var mimeType = dataUriRegexResult[1];\n      var isBase64 = !!dataUriRegexResult[2];\n      var data = dataUriRegexResult[3];\n      data = decodeURIComponent(data);\n      if (isBase64) data = atob(data);\n\n      try {\n        var response;\n        var responseType = (this.responseType || '').toLowerCase();\n\n        switch (responseType) {\n          case 'arraybuffer':\n          case 'blob':\n            var view = new Uint8Array(data.length);\n\n            for (var i = 0; i < data.length; i++) {\n              view[i] = data.charCodeAt(i);\n            }\n\n            if (responseType === 'blob') {\n              response = new Blob([view.buffer], {\n                type: mimeType\n              });\n            } else {\n              response = view.buffer;\n            }\n\n            break;\n\n          case 'document':\n            var parser = new DOMParser();\n            response = parser.parseFromString(data, mimeType);\n            break;\n\n          case 'json':\n            response = JSON.parse(data);\n            break;\n\n          default:\n            // 'text' or other\n            response = data;\n            break;\n        } // Wait for next browser tick like standard XMLHttpRequest event dispatching does\n\n\n        setTimeout(function () {\n          if (onLoad) onLoad(response);\n          scope.manager.itemEnd(url);\n        }, 0);\n      } catch (error) {\n        // Wait for next browser tick like standard XMLHttpRequest event dispatching does\n        setTimeout(function () {\n          if (onError) onError(error);\n          scope.manager.itemError(url);\n          scope.manager.itemEnd(url);\n        }, 0);\n      }\n    } else {\n      // Initialise array for duplicate requests\n      loading[url] = [];\n      loading[url].push({\n        onLoad: onLoad,\n        onProgress: onProgress,\n        onError: onError\n      });\n      var request = new XMLHttpRequest();\n      request.open('GET', url, true);\n      request.addEventListener('load', function (event) {\n        var response = this.response;\n        Cache.add(url, response);\n        var callbacks = loading[url];\n        delete loading[url];\n\n        if (this.status === 200 || this.status === 0) {\n          // Some browsers return HTTP Status 0 when using non-http protocol\n          // e.g. 'file://' or 'data://'. Handle as success.\n          if (this.status === 0) console.warn('THREE.FileLoader: HTTP Status 0 received.');\n\n          for (var i = 0, il = callbacks.length; i < il; i++) {\n            var callback = callbacks[i];\n            if (callback.onLoad) callback.onLoad(response);\n          }\n\n          scope.manager.itemEnd(url);\n        } else {\n          for (var i = 0, il = callbacks.length; i < il; i++) {\n            var callback = callbacks[i];\n            if (callback.onError) callback.onError(event);\n          }\n\n          scope.manager.itemError(url);\n          scope.manager.itemEnd(url);\n        }\n      }, false);\n      request.addEventListener('progress', function (event) {\n        var callbacks = loading[url];\n\n        for (var i = 0, il = callbacks.length; i < il; i++) {\n          var callback = callbacks[i];\n          if (callback.onProgress) callback.onProgress(event);\n        }\n      }, false);\n      request.addEventListener('error', function (event) {\n        var callbacks = loading[url];\n        delete loading[url];\n\n        for (var i = 0, il = callbacks.length; i < il; i++) {\n          var callback = callbacks[i];\n          if (callback.onError) callback.onError(event);\n        }\n\n        scope.manager.itemError(url);\n        scope.manager.itemEnd(url);\n      }, false);\n      request.addEventListener('abort', function (event) {\n        var callbacks = loading[url];\n        delete loading[url];\n\n        for (var i = 0, il = callbacks.length; i < il; i++) {\n          var callback = callbacks[i];\n          if (callback.onError) callback.onError(event);\n        }\n\n        scope.manager.itemError(url);\n        scope.manager.itemEnd(url);\n      }, false);\n      if (this.responseType !== undefined) request.responseType = this.responseType;\n      if (this.withCredentials !== undefined) request.withCredentials = this.withCredentials;\n      if (request.overrideMimeType) request.overrideMimeType(this.mimeType !== undefined ? this.mimeType : 'text/plain');\n\n      for (var header in this.requestHeader) {\n        request.setRequestHeader(header, this.requestHeader[header]);\n      }\n\n      request.send(null);\n    }\n\n    scope.manager.itemStart(url);\n    return request;\n  },\n  setPath: function (value) {\n    this.path = value;\n    return this;\n  },\n  setResponseType: function (value) {\n    this.responseType = value;\n    return this;\n  },\n  setWithCredentials: function (value) {\n    this.withCredentials = value;\n    return this;\n  },\n  setMimeType: function (value) {\n    this.mimeType = value;\n    return this;\n  },\n  setRequestHeader: function (value) {\n    this.requestHeader = value;\n    return this;\n  }\n});\nexport { FileLoader };","map":{"version":3,"sources":["/Users/bcraig/Desktop/TATLC/node_modules/three/src/loaders/FileLoader.js"],"names":["Cache","DefaultLoadingManager","loading","FileLoader","manager","undefined","Object","assign","prototype","load","url","onLoad","onProgress","onError","path","resolveURL","scope","cached","get","itemStart","setTimeout","itemEnd","push","dataUriRegex","dataUriRegexResult","match","mimeType","isBase64","data","decodeURIComponent","atob","response","responseType","toLowerCase","view","Uint8Array","length","i","charCodeAt","Blob","buffer","type","parser","DOMParser","parseFromString","JSON","parse","error","itemError","request","XMLHttpRequest","open","addEventListener","event","add","callbacks","status","console","warn","il","callback","withCredentials","overrideMimeType","header","requestHeader","setRequestHeader","send","setPath","value","setResponseType","setWithCredentials","setMimeType"],"mappings":"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","sourcesContent":["/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nimport { Cache } from './Cache.js';\nimport { DefaultLoadingManager } from './LoadingManager.js';\n\nvar loading = {};\n\nfunction FileLoader( manager ) {\n\n\tthis.manager = ( manager !== undefined ) ? manager : DefaultLoadingManager;\n\n}\n\nObject.assign( FileLoader.prototype, {\n\n\tload: function ( url, onLoad, onProgress, onError ) {\n\n\t\tif ( url === undefined ) url = '';\n\n\t\tif ( this.path !== undefined ) url = this.path + url;\n\n\t\turl = this.manager.resolveURL( url );\n\n\t\tvar scope = this;\n\n\t\tvar cached = Cache.get( url );\n\n\t\tif ( cached !== undefined ) {\n\n\t\t\tscope.manager.itemStart( url );\n\n\t\t\tsetTimeout( function () {\n\n\t\t\t\tif ( onLoad ) onLoad( cached );\n\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, 0 );\n\n\t\t\treturn cached;\n\n\t\t}\n\n\t\t// Check if request is duplicate\n\n\t\tif ( loading[ url ] !== undefined ) {\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\treturn;\n\n\t\t}\n\n\t\t// Check for data: URI\n\t\tvar dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\n\t\tvar dataUriRegexResult = url.match( dataUriRegex );\n\n\t\t// Safari can not handle Data URIs through XMLHttpRequest so process manually\n\t\tif ( dataUriRegexResult ) {\n\n\t\t\tvar mimeType = dataUriRegexResult[ 1 ];\n\t\t\tvar isBase64 = !! dataUriRegexResult[ 2 ];\n\t\t\tvar data = dataUriRegexResult[ 3 ];\n\n\t\t\tdata = decodeURIComponent( data );\n\n\t\t\tif ( isBase64 ) data = atob( data );\n\n\t\t\ttry {\n\n\t\t\t\tvar response;\n\t\t\t\tvar responseType = ( this.responseType || '' ).toLowerCase();\n\n\t\t\t\tswitch ( responseType ) {\n\n\t\t\t\t\tcase 'arraybuffer':\n\t\t\t\t\tcase 'blob':\n\n\t\t\t\t\t\tvar view = new Uint8Array( data.length );\n\n\t\t\t\t\t\tfor ( var i = 0; i < data.length; i ++ ) {\n\n\t\t\t\t\t\t\tview[ i ] = data.charCodeAt( i );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( responseType === 'blob' ) {\n\n\t\t\t\t\t\t\tresponse = new Blob( [ view.buffer ], { type: mimeType } );\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tresponse = view.buffer;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'document':\n\n\t\t\t\t\t\tvar parser = new DOMParser();\n\t\t\t\t\t\tresponse = parser.parseFromString( data, mimeType );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'json':\n\n\t\t\t\t\t\tresponse = JSON.parse( data );\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault: // 'text' or other\n\n\t\t\t\t\t\tresponse = data;\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onLoad ) onLoad( response );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t} catch ( error ) {\n\n\t\t\t\t// Wait for next browser tick like standard XMLHttpRequest event dispatching does\n\t\t\t\tsetTimeout( function () {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\n\t\t\t\t\tscope.manager.itemError( url );\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, 0 );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// Initialise array for duplicate requests\n\n\t\t\tloading[ url ] = [];\n\n\t\t\tloading[ url ].push( {\n\n\t\t\t\tonLoad: onLoad,\n\t\t\t\tonProgress: onProgress,\n\t\t\t\tonError: onError\n\n\t\t\t} );\n\n\t\t\tvar request = new XMLHttpRequest();\n\n\t\t\trequest.open( 'GET', url, true );\n\n\t\t\trequest.addEventListener( 'load', function ( event ) {\n\n\t\t\t\tvar response = this.response;\n\n\t\t\t\tCache.add( url, response );\n\n\t\t\t\tvar callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tif ( this.status === 200 || this.status === 0 ) {\n\n\t\t\t\t\t// Some browsers return HTTP Status 0 when using non-http protocol\n\t\t\t\t\t// e.g. 'file://' or 'data://'. Handle as success.\n\n\t\t\t\t\tif ( this.status === 0 ) console.warn( 'THREE.FileLoader: HTTP Status 0 received.' );\n\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar callback = callbacks[ i ];\n\t\t\t\t\t\tif ( callback.onLoad ) callback.onLoad( response );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\t\tvar callback = callbacks[ i ];\n\t\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.manager.itemError( url );\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'progress', function ( event ) {\n\n\t\t\t\tvar callbacks = loading[ url ];\n\n\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onProgress ) callback.onProgress( event );\n\n\t\t\t\t}\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'error', function ( event ) {\n\n\t\t\t\tvar callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, false );\n\n\t\t\trequest.addEventListener( 'abort', function ( event ) {\n\n\t\t\t\tvar callbacks = loading[ url ];\n\n\t\t\t\tdelete loading[ url ];\n\n\t\t\t\tfor ( var i = 0, il = callbacks.length; i < il; i ++ ) {\n\n\t\t\t\t\tvar callback = callbacks[ i ];\n\t\t\t\t\tif ( callback.onError ) callback.onError( event );\n\n\t\t\t\t}\n\n\t\t\t\tscope.manager.itemError( url );\n\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t}, false );\n\n\t\t\tif ( this.responseType !== undefined ) request.responseType = this.responseType;\n\t\t\tif ( this.withCredentials !== undefined ) request.withCredentials = this.withCredentials;\n\n\t\t\tif ( request.overrideMimeType ) request.overrideMimeType( this.mimeType !== undefined ? this.mimeType : 'text/plain' );\n\n\t\t\tfor ( var header in this.requestHeader ) {\n\n\t\t\t\trequest.setRequestHeader( header, this.requestHeader[ header ] );\n\n\t\t\t}\n\n\t\t\trequest.send( null );\n\n\t\t}\n\n\t\tscope.manager.itemStart( url );\n\n\t\treturn request;\n\n\t},\n\n\tsetPath: function ( value ) {\n\n\t\tthis.path = value;\n\t\treturn this;\n\n\t},\n\n\tsetResponseType: function ( value ) {\n\n\t\tthis.responseType = value;\n\t\treturn this;\n\n\t},\n\n\tsetWithCredentials: function ( value ) {\n\n\t\tthis.withCredentials = value;\n\t\treturn this;\n\n\t},\n\n\tsetMimeType: function ( value ) {\n\n\t\tthis.mimeType = value;\n\t\treturn this;\n\n\t},\n\n\tsetRequestHeader: function ( value ) {\n\n\t\tthis.requestHeader = value;\n\t\treturn this;\n\n\t}\n\n} );\n\n\nexport { FileLoader };\n"]},"metadata":{},"sourceType":"module"}